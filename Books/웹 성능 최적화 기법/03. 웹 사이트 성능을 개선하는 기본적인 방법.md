# 웹 사이트 성능을 개선하는 기본적인 방법

## 1. HTTP 요청 수 줄이기

- 웹 서핑을 하는 사용자들에게 보이지 않지만 API 호출을 위한 AJAX 요청이나 API 전용 도메인에 대한 HTTP 호출 등 내부에서 웹 사이트의 기능을 수행하는 컨텐츠들도 많이 존재한다.
- 웹 페이지에서 요청하는 컨텐츠의 수가 많을수록 로딩 완료 시간은 길어진다. 반대로 이미지같은 컨텐츠가 적은 페이지는 매우 빠르게 로딩이 된다.
- 즉 웹 페이지를 단순하게 제작하는 것이 HTTP 프로토콜 요청 수를 줄이는 가장 쉬운 방법이다.
- 첫번째 방법으로는 `스크립트 파일을 병합하는 것으로 여러 파일들을 하나로 합치고 호출을 줄이는 것`이다.
- 두번째 방법으로는 CSS 안에 해시 정보를 통해 웹 페이지 배경 이미지 파일을 삽입해 받아오는 `인라인 이미지(inline image)`다. 대신 이 방식은 별도의 이미지 파일을 받아오는 것이 아니라 인터넷이나 브라우저에 캐시할 수 없으며, HTML이 캐시되어야 동시에 캐시할 수 있다.
- 세번째 방법은 `CSS 스프라이트(CSS sprite)`다. 여러 개의 이미지를 하나의 이미지 파일로 결합해 필요한 이미지가 위치하는 픽셀 좌표 정보를 사용하는 방식이다. 주로 아이콘이나 버튼 등 작은 이미지를 사용할 때 유리하다.

## 2. 컨텐츠 파일 크기 줄이기

- 우리가 여러 파일을 하나의 zip 파일로 압축해 전달하면 용량도 줄이고 속도도 빠르게 할 수 있듯, HTTP 프로토콜의 Accept-Encoding, Content-Encoding 헤더를 사용해 압축한 스크립트들의 정보 교환을 지원해 사용할 수 있다.
- ex ) Accept-Encoding: gzip, deflate, sdch / Content-Encoding: gzip
- 다음으로 `스크립트 파일 최소화` 기법이 있는데, 이는 코딩된 스크립트 파일에 포함된 주석문, 공백, 개행 문자 등 실제 로직에 아무런 영향을 주지 않는 부분을 제거해 전반적인 파일 크기를 줄이는 것을 말한다.
- 세번째로는 웹 사이트에서 가장 많은 용량을 차지하는 컨텐츠인 `이미지를 압축`하는 것이다. 주로 해당 촬영 정보가 담긴 메타 데이터가 용량에 영향을 꽤 주는데, 이런 부분을 제거해 올리는 것도 하나의 좋은 방법이 된다.
- 네번째로는 `브라우저가 선호하는 이미지 포맷`을 사용하는 것이다. WebP(구글 개발)와 JPEG XR(마이크로소프트 개발)이 대표적인 예시다.
- 다섯번째로 모든 파일을 초기에 다운로드하도록 하는 것이 아닌 `큰 파일을 작게 나누어 전송`해 향상시키는 것이다. HTTP 응답 헤더로 초기 파일 전달 크기나 파일 범위를 설정해 사용할 수 있다.

## 3. 캐시 최적화하기

- 캐시는 자주 사용되는 컨텐츠나 특정 데이터 등을 임의의 저장소에 복제해두고 재사용하는 방식을 의미한다.
- 이를 주로 담당하는 시스템은 프록시 서버(proxy server)로 인터넷의 수많은 경로에 거미줄처럼 존재한다.
- 프록시 서버는 클라이언트가 처음 요청한 컨텐츠를 원본 서버(origin server)에 대신 요청하여 클라이언트에게 전달해주고 이를 스스로 저장한다.
- 이후 다른 클라이언트가 동일한 컨텐츠를 요청했을 때 원본 서버에 접속할 필요 없이 자체 저장한 컨텐츠를 제공한다.
- 프록시 서버는 사용자가 많은 지역에 여러 곳을 선택해 설치한다. 이를 통해 프록시 서버 근처에 있는 유저는 원래 서버의 응답 속도보다 빠르게 컨텐츠를 전달받을 수 있다.
- 또한 원본 서버로 몰릴 수 있는 인터넷 트래픽을 분산해 서버 자원을 절약할 수 있다.
- 프록시 서버 외에도 브라우저 캐시도 사용할 수 있다. HTTP 헤더의 Cache-Control 값을 활용해 민감하지 않은, 하지만 자주 사용하는 컨텐츠를 캐싱할 수 있다.