# Hydration

1. 개념
   - Server Side 단에서 렌더링된 정적 페이지와 번들링된 JS 파일을 클라이언트에 보낸 뒤, `클라이언트 단에서 HTML 코드와 React인 JS 코드를 서로 매칭`시키는 과정.
   
   <br/>
   
2. Why hydrate?
   - React는 JS 파일만을 이용해 웹 화면을 구성하는 원리를 가지고 있다.
   - 그래서 실제 HTML에는 내용이 없는 상태이기에 SEO에 적합하지 않았다.
   - 이를 해결하기 위해 Next.js와 같은 프레임워크로 서버에서 pre-rendering을 진행해 HTML document를 클라이언트에 전송하는 방식을 사용하기 시작했다.
   - 이 떄 pre-rendering 과정을 통해 클라이언트에서 받은 웹 페이지는 단순히 화면만 보여주는, 자바스크립트 요소가 없는 빈 껍데기이다.
   - 그래서 이 페이지를 클라이언트에 보내고 나면 리액트가 번들링된 자바스크립트 코드들을 이어서 보내준다.
   - chunk 단위로 다운로드된 JS 파일들은 이전에 보내진 HTML DOM 요소 위에서 한번 더 렌더링을 하면서 각자 자기 자리를 찾아가며 매칭된다.
   - 이것이 `hydration` 이며 마치 `자바스크립트 코드들이 DOM 요소 위에 물을 채우듯 필요한 요소들을 채우는` 듯해 다음과 같은 용어를 사용한다고 한다.

   <br/>

3. 그렇다면 이는 두번 렌더링한다는 것인데..?
   - 비효율적인 것처럼 보일 수 있지만 서버에서 빠르게 pre-rendering하고 유저에게 빠른 웹페이지로 응답할 수 있다는 것에 더욱 큰 이점이 있다.
   - 또한 pre-rendering한 document는 자바스크립트 요소들이 빠진 가벼운 상태이기에 클라이언트에서 빠른 로딩이 가능하다.
   - 그리고 이렇게 렌더링하는 과정에서 웹 페이지를 다시 그리는 과정(paint) 없이 매칭만 시킨다.

   <br/>
   
4. hydration의 단점
   - hydration 방식은 `pre-rendering 된 DOM 요소의 모든 script는 무조건 모두 가져온다.`
   - 이에 Document에 포함된 모든 DOM 요소의 Script가 전부 요청돼서 가져오다 보니, 현재 뷰 포트에서 벗어나 있는 컨텐츠 영역에 대한 Chunk File들도 서버에 요청해 불필요한 Hydration 작업을 하게 된다.
   - 이러한 단점을 해결(?)할 수 있는 방법으로 lazy-hydration이 있다고 한다! [참고 링크](https://helloinyong.tistory.com/323?category=1008748)



